<!DOCTYPE html>  <html lang="en">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
<title>Benakasemmemii Translator 2026</title>  <style>  
:root { --primary: #2c3e50; --accent: #3498db; --bg: #f4f7f6; }  
body {  
    font-family: 'Segoe UI', Tahoma, sans-serif;  
    background: var(--bg);  
    margin: 0;  
    display: flex;  
    flex-direction: column;  
    align-items: center;  
}  
header {  
    width: 100%;  
    background: var(--primary);  
    color: white;  
    padding: 1.5rem 0;  
    text-align: center;  
}  
.container {  
    max-width: 1100px;  
    width: 95%;  
    margin: 2rem 0;  
    background: white;  
    padding: 2rem;  
    border-radius: 15px;  
}  
.controls {  
    display: flex;  
    justify-content: space-between;  
    gap: 10px;  
    margin-bottom: 1rem;  
}  
select, button {  
    padding: 10px;  
    font-size: 1rem;  
}  
.text-areas {  
    display: grid;  
    grid-template-columns: 1fr 1fr;  
    gap: 1rem;  
}  
textarea {  
    width: 100%;  
    height: 260px;  
    font-size: 1.1rem;  
    padding: 10px;  
}  
.translate-btn {  
    width: 100%;  
    margin-top: 1rem;  
    padding: 12px;  
    background: var(--accent);  
    color: white;  
    border: none;  
    font-weight: bold;  
}  
@media (max-width: 768px) {  
    .text-areas { grid-template-columns: 1fr; }  
}  
</style>  </head>  
<body>  <header>  
<h1>Benakasemmemii Translator</h1>  
<p>Made in 2026</p>  

<div class="beta-banner" style="
    background-color: #f9e79f; 
    color: #7d6608; 
    padding: 10px 15px; 
    border-radius: 8px; 
    text-align: center; 
    margin-bottom: 1rem;
    font-weight: bold;
">
    Beta Version – Currently only English → Benakasemmemii is available.<br>
    Other languages will be unlocked in the coming months. Stay tuned!
</div>

</header>  <div class="container">  
    <div class="controls">  
        <select id="sourceLang">  
            <option value="bnk">Benakasemmemii</option>  
            <option value="en" selected>English</option> 
            <option value="es">Spanish (Google API)</option>
            <option value="hi">Hindi</option>
            <option value="ar">Arabic (Google API)</option>
            <option value="fr">French (Google API)</option>
            <option value="pt">Portuguese (Google API)</option>
            <option value="ru">Russian</option>  
            <option value="ja">Japanese</option>  
            <option value="de">German (Google API)</option>
            <option value="pl">Polish (Google API)</option>  
        </select>  <button onclick="swapLangs()">⇄</button>  

    <select id="targetLang">  
        <option value="bnk">Benakasemmemii</option>  
    </select>  
</div>  

<div class="text-areas">  
    <textarea id="inputText" placeholder="Enter a text..."></textarea>  
<button class="translate-btn" onclick="runTranslation()">Translate</button>  
    <textarea id="outputText" readonly placeholder="Translating..."></textarea>  
</div>  


<div class="footer-tools">  
    <a href="mailto:benakasemmemii.creator@gmail.com" class="btn-link">Give your opinion</a>  
    <a href="buycoffee.to" target="_blank" class="btn-link" style="color: #e67e22;">Voluntary payment</a>  
</div>

</div>  <div id="ad-space">The place for an ad (supporting Google Cloud API)</div>

<script>
/* =========================================================
   MOLTEKIDU
========================================================= */

const TranslationData = {};

async function loadLanguagePair(source, target) {
    const key = `${source}_${target}`;
    if (TranslationData[key]) return TranslationData[key];

    // GitHub Pages paajina-de shuddha URL yutakai
    const base = `https://arthapuurna.github.io/molmuutattakai/data/${key}`;

    try {
        // kul fail-no "fetch" karkii samahe
        const [wordsRes, phrasesRes, orderingRes] = await Promise.all([
            fetch(`${base}/words.json`),
            fetch(`${base}/phrases.json`),
            fetch(`${base}/ordering.json`)
        ]);

        // rankaneda-no tekijorkii
        if (!wordsRes.ok || !phrasesRes.ok || !orderingRes.ok) {
            throw new Error("One or more files could not be fetched");
        }

        const [words, phrases, ordering] = await Promise.all([
            wordsRes.json(),
            phrasesRes.json(),
            orderingRes.json()
        ]);

        const data = { words, phrases, orderingMap: ordering };
        TranslationData[key] = data;
        return data;

    } catch (e) {
        console.error("Failed to fetch translation data:", e);
        return null;
    }
}

/* =========================================================
   UI
========================================================= */

function swapLangs() {
    const s = sourceLang.value;
    sourceLang.value = targetLang.value;
    targetLang.value = s;
}

async function runTranslation() {
    const text = inputText.value.trim();
    if (!text) { outputText.value = ""; return; }

    const source = sourceLang.value;
    const target = targetLang.value;

    if (source === "es" || target === "bnk") {
        outputText.value = "Google API – ita demo kitu-de non-kriyaapun.";
        return;
    }

    if (source === "bnk" || target === "es") {
    outputText.value = "Google API – ita demo kitu-de non-kriyaapun.";
    return;
    }

    const data = await loadLanguagePair(source, target);
outputText.value = internalBenTranslate(text, target, source, data);
 }

/* =========================================================
   MOLMUUTATTAKIITUGATTAKAI
========================================================= */


    // ===== STANDARD EN → BNK =====

function internalBenTranslate(text, target, source, data) {
    if (!(source === "en" && target === "bnk")) return text;
    if (!data) return text;

    const sentenceParts = text.match(/[^.!?]+[.!?]?/g) || [text];
    let translatedText = "";

    sentenceParts.forEach(sentence => {
        sentence = sentence.trim();
        if (!sentence) return;

        const punct = sentence.match(/[.!?]$/);
        const endPunct = punct ? punct[0] : "";
        if (endPunct) sentence = sentence.slice(0, -1);

        // === PHRASES ===
        Object.entries(data.phrases || {}).forEach(([src, trg]) => {
            const r = new RegExp("\\b" + src + "\\b", "gi");
            sentence = sentence.replace(r, trg);
        });

        // === WORDS ===
        let tokens = sentence.split(/\s+/).map(token => {
            const m = token.match(/^([("']*)([a-zA-Z]+)([)"',;:]*)$/);
            if (!m) return token;

            const [, pre, wordRaw, post] = m;
            const word = wordRaw.toLowerCase();
            const tr = data.words[word] || word;

            return pre + tr + post;
        });

        // === ORDERING ===
        tokens = applyOrderingMap(tokens, data.orderingMap);
        tokens = tokens.map(t => t.replace(/\{\{[^}]+\}\}/g, ""));

        translatedText += capitalize(tokens.join(" ")) + (endPunct || " ") + " ";
    });

    return translatedText.trim();
}


/* =========================================================
   ORDERING MAP (LINGOJAM-STYLE)
========================================================= */

function applyOrderingMap(tokens, orderingMap) {

    function extractTag(token) {
        const m = token.match(/\{\{[^}]+\}\}/);
        return m ? m[0] : "";
    }

    let changed = true;

    while (changed) {
        changed = false;

        for (const [srcPattern, tgtPattern] of Object.entries(orderingMap)) {

            const srcTags = srcPattern.split(" ");
            const tgtTags = tgtPattern.split(" ");

            for (let i = 0; i <= tokens.length - srcTags.length; i++) {

                const window = tokens.slice(i, i + srcTags.length);
                const windowTags = window.map(extractTag);

                // TAGUS-NO TULANAA
                let match = true;
                for (let j = 0; j < srcTags.length; j++) {
                    if (windowTags[j] !== srcTags[j]) {
                        match = false;
                        break;
                    }
                }
                if (!match) continue;

                // REORDER — kukkun ONTII TOUKENS-ONG bekarre
                const reordered = tgtTags.map(tag =>
                    window[windowTags.indexOf(tag)]
                );

                tokens.splice(i, srcTags.length, ...reordered);
                changed = true;
                break;
            }

            if (changed) break;
        }
    }

    return tokens;
}

/* =========================================================
   HELPERS
========================================================= */

function capitalize(s) {
  return s.charAt(0).toUpperCase() + s.slice(1);
}

/*==JORKII-NO BHAASAA==*/

let UI = {};
const supportedLangs = [
  "en","es","zh","hi","ar","id","fr","pt",
  "ru","ja","tr","ko","it","pl","hu","bnk"
];

async function loadInterface(lang) {

    if (!supportedLangs.includes(lang)) {
        lang = "en";
    }

    try {
        const response = await fetch(`i18n/${lang}.json`);
        UI = await response.json();
    } catch {
        const fallback = await fetch(`i18n/en.json`);
        UI = await fallback.json();
        lang = "en";
    }

    localStorage.setItem("ui_lang", lang);

    applyInterface(lang);
    populateLanguageSelector(lang);
}

function applyInterface(lang) {

    document.querySelector("h1").textContent = UI.title;
    document.querySelector("header p").textContent = UI.made;
    document.getElementById("inputText").placeholder = UI.enter_text;
    document.querySelector(".translate-btn").textContent = UI.translate;
    document.getElementById("ad-space").textContent = UI.ad_space;

    // Arabii-ke RTL
    document.body.dir = (lang === "ar") ? "rtl" : "ltr";
}

function detectLanguage() {

    const urlParams = new URLSearchParams(window.location.search);
    const urlLang = urlParams.get("lang");
    if (urlLang) return urlLang;

    const saved = localStorage.getItem("ui_lang");
    if (saved) return saved;

    return navigator.language.slice(0,2);
}

function changeLanguage(lang) {
    loadInterface(lang);
}

function populateLanguageSelector(currentLang) {
    const select = document.getElementById("uiLangSelector");
    select.innerHTML = "";

    supportedLangs.forEach(code => {
        const option = document.createElement("option");
        option.value = code;
        option.textContent = code.toUpperCase();
        if (code === currentLang) option.selected = true;
        select.appendChild(option);
    });
}

loadInterface(detectLanguage());

</script>
</body>  
</html>  
